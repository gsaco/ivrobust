{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":"Weak-IV robust inference in Python  # ivrobust keeps inference credible when instruments are weak.   Research-grade Anderson-Rubin, LM/K, and CLR inference with robust covariance options, set-valued confidence sets, and diagnostics aligned with modern weak-instrument guidance.    [Quickstart](quickstart.md){ .md-button .md-button--primary } [User guide](user-guide/index.md){ .md-button } [Notebooks](notebooks.md){ .md-button }   AR / LM / CLRUnified weak-IV workflow. Robust covarianceHC0-HC3 and clustering. Set-valued CIsDisjoint intervals supported. <pre><code>import ivrobust as ivr\n\ndata, beta_true = ivr.weak_iv_dgp(n=300, k=5, strength=0.4, beta=1.0, seed=0)\n\nres = ivr.weakiv_inference(\n    data,\n    beta0=beta_true,\n    alpha=0.05,\n    methods=(\"AR\", \"LM\", \"CLR\"),\n    cov_type=\"HC1\",\n)\nprint(res.tests[\"AR\"].pvalue)\nprint(res.confidence_sets[\"CLR\"].intervals)\n</code></pre> <ol> <li> <p>T. W. Anderson and Herman Rubin. Estimation of the parameters of a single equation in a complete system of stochastic equations. The Annals of Mathematical Statistics, 20(1):46\u201363, 1949. doi:10.1214/aoms/1177730090.\u00a0\u21a9</p> </li> <li> <p>Isaiah Andrews, James H. Stock, and Liyang Sun. Weak instruments in instrumental variables regression: theory and practice. Annual Review of Economics, 2019. doi:10.1146/annurev-economics-080218-025643.\u00a0\u21a9</p> </li> <li> <p>Frank Kleibergen. Pivotal statistics for testing structural parameters in instrumental variables regression. Econometrica, 70(5):1781\u20131803, 2002. doi:10.1111/1468-0262.00353.\u00a0\u21a9</p> </li> <li> <p>Marcelo J. Moreira. A conditional likelihood ratio test for structural models. Econometrica, 71(4):1027\u20131048, 2003. doi:10.1111/1468-0262.00438.\u00a0\u21a9</p> </li> <li> <p>Anna Mikusheva. Robust confidence sets in the presence of weak instruments. Journal of Econometrics, 157(2):236\u2013247, 2010. doi:10.1016/j.jeconom.2009.12.003.\u00a0\u21a9</p> </li> <li> <p>Keith Finlay and Leandro M. Magnusson. Implementing weak-instrument robust tests for a general class of instrumental-variables models. The Stata Journal, 9(3):398\u2013421, 2009. doi:10.1177/1536867X0900900304.\u00a0\u21a9</p> </li> <li> <p>Jose Luis Montiel Olea and Carolin E. Pflueger. A robust test for weak instruments. Journal of Business &amp; Economic Statistics, 31(3):358\u2013369, 2013. doi:10.1080/00401706.2013.806694.\u00a0\u21a9</p> </li> </ol>"},{"location":"#why-this-matters","title":"Why this matters","text":"<p>Weak instruments invalidate classical IV inference. ivrobust keeps tests valid under weak identification, reports diagnostics alongside inference, and produces publication-quality figures with a single, consistent plotting style.</p>"},{"location":"#trust-and-reproducibility","title":"Trust and reproducibility","text":"<p>Continuous integration</p> <p>CI runs linting, type checks, unit tests, notebook execution, docs builds, and link checks on pushes to <code>main</code>.</p> <p>Reproducible figures</p> <p>Every figure on the site is generated by committed code and fixed seeds.</p> <p>Clear scope</p> <p>Weak-IV robust inference is implemented for a single endogenous regressor with set-valued confidence sets.</p>"},{"location":"#methods-at-a-glance","title":"Methods at a glance","text":"<ul> <li> <p> Anderson-Rubin (AR)</p> <p>Invert the joint test on instruments for weak-IV robust inference and confidence sets. <sup>1</sup><sup>2</sup></p> </li> <li> <p> LM/K test</p> <p>Kleibergen-Paap LM statistics for scalar structural parameters with robust covariance support. <sup>3</sup></p> </li> <li> <p> CLR / CQLR</p> <p>Conditional likelihood ratio inference with grid inversion for confidence sets. <sup>4</sup></p> </li> <li> <p> Set-valued confidence sets</p> <p>Disjoint or unbounded intervals are allowed and reported explicitly. <sup>5</sup></p> </li> <li> <p> Robust covariance</p> <p>HC0-HC3 and one-way clustering for reliable inference under heteroskedasticity. <sup>6</sup></p> </li> <li> <p> Diagnostics</p> <p>Effective F, KP-rk, and weak-ID diagnostics for instrument strength. <sup>7</sup></p> </li> </ul>"},{"location":"#featured-demos","title":"Featured demos","text":"[Quickstart](quickstart.md){ .md-button .md-button--primary } [Diagnostics](diagnostics-interpretation.md){ .md-button } [Gallery](gallery.md){ .md-button }"},{"location":"#gallery-highlights","title":"Gallery highlights","text":"Monte Carlo rejection rates across instrument strength. AR, LM, and CLR p-values across the beta grid. Runtime scaling for the unified weak-IV workflow. <p>Explore the full Gallery for additional figures and captions.</p>"},{"location":"#start-here","title":"Start here","text":"[Quickstart](quickstart.md){ .md-button .md-button--primary } [User guide](user-guide/index.md){ .md-button } [Notebooks](notebooks.md){ .md-button }"},{"location":"#reproducible-by-design","title":"Reproducible by design","text":"<ul> <li>Deterministic data generators for weak-IV benchmarks.</li> <li>Figures saved with ivrobust plotting conventions for papers and reports.</li> <li>Notebooks curated for applied workflows and reproducibility checks.</li> </ul>"},{"location":"diagnostics-interpretation/","title":"Diagnostics and interpretation","text":"<p>Weak-IV robust inference is only as good as the diagnostics you report. This page summarizes what ivrobust computes, how to interpret it, and which outputs are valid under weak identification.</p>"},{"location":"diagnostics-interpretation/#estimators-vs-tests-vs-confidence-sets","title":"Estimators vs tests vs confidence sets","text":"<ul> <li>Estimators (2SLS, LIML, Fuller) provide point estimates and standard   errors.</li> <li>Tests (AR, LM/K, CLR) remain valid under weak identification for a single   endogenous regressor.</li> <li>Confidence sets are obtained by inverting tests and can be disjoint or   unbounded.</li> </ul> <p>If instruments are weak, rely on the weak-IV robust tests and confidence sets rather than conventional t-tests from 2SLS.</p>"},{"location":"diagnostics-interpretation/#core-diagnostics-in-ivrobust","title":"Core diagnostics in ivrobust","text":"<pre><code>import ivrobust as ivr\n\ndiag = ivr.first_stage_diagnostics(data)\neff_f = ivr.effective_f(data, cov_type=\"HC1\")\nweak = ivr.weak_id_diagnostics(data, cov_type=\"HC1\")\nkp_rk = ivr.kp_rank_test(data, cov_type=\"HC1\")\n</code></pre> <p>How to read them</p> <ul> <li>First-stage F / partial R^2: Low values signal weak instruments. These are   convenient summaries, but they do not guarantee valid inference under weak ID.</li> <li>Effective F (Montiel Olea-Pflueger): A robust diagnostic intended for   heteroskedastic settings. Treat small values as a warning sign.   <sup>1</sup></li> <li>KP-rk test: Tests underidentification. A weak or insignificant result   suggests insufficient instrument relevance.</li> </ul>"},{"location":"diagnostics-interpretation/#safe-defaults","title":"Safe defaults","text":"<ul> <li>Use <code>weakiv_inference(..., methods=(\"AR\", \"LM\", \"CLR\"))</code> and report the full   set-valued confidence sets.</li> <li>For most workflows, use the package-wide default <code>cov_type=\"HC1\"</code> unless your   design requires clustering.</li> <li>When instrument strength is low, emphasize AR/LM/CLR results and use 2SLS   standard errors only for descriptive reporting.</li> </ul>"},{"location":"diagnostics-interpretation/#common-pitfalls","title":"Common pitfalls","text":"<ul> <li>Treating a narrow 2SLS interval as conclusive under weak instruments.</li> <li>Suppressing disjoint intervals instead of reporting the union of sets.</li> <li>Ignoring clustering when the data are clearly grouped.</li> </ul>"},{"location":"diagnostics-interpretation/#scope-reminders","title":"Scope reminders","text":"<p>ivrobust's weak-IV robust tests currently target a single endogenous regressor (<code>p_endog=1</code>). For multiple endogenous regressors, interpret results with care and consult the roadmap.</p> <ol> <li> <p>Jose Luis Montiel Olea and Carolin E. Pflueger. A robust test for weak instruments. Journal of Business &amp; Economic Statistics, 31(3):358\u2013369, 2013. doi:10.1080/00401706.2013.806694.\u00a0\u21a9</p> </li> </ol>"},{"location":"faq/","title":"FAQ","text":""},{"location":"faq/#why-is-my-confidence-set-disjoint-or-unbounded","title":"Why is my confidence set disjoint or unbounded?","text":"<p>This can occur under weak identification. In weak-IV robust inference, it is common that the identified set is wide or even effectively unbounded for plausible confidence levels.</p>"},{"location":"faq/#should-i-report-2sls-standard-errors","title":"Should I report 2SLS standard errors?","text":"<p>You can report them as conventional strong-ID standard errors, but they are not weak-IV robust. If instrument strength is questionable, report weak-IV robust inference (for example, an AR confidence set) alongside 2SLS estimates.</p>"},{"location":"gallery/","title":"Gallery","text":"<p>Publication-style figures generated directly from ivrobust. Each figure below links to the notebook or script that produces it.</p> <p></p>  AR confidence set with set-valued intervals. [PDF](assets/figures/ar_confidence_set.pdf) Source: [00_quickstart.ipynb](https://github.com/gsaco/ivrobust/blob/main/notebooks/00_quickstart.ipynb)  <p></p>  AR, LM, and CLR p-values across the beta grid. [PDF](assets/figures/pvalue_curve.pdf) Source: [05_clr_in_practice.ipynb](https://github.com/gsaco/ivrobust/blob/main/notebooks/05_clr_in_practice.ipynb)  <p></p>  Monte Carlo rejection rates across instrument strength (AR vs 2SLS t-test). [PDF](assets/figures/rejection_vs_strength.pdf) Source: [03_simulation_study.ipynb](https://github.com/gsaco/ivrobust/blob/main/notebooks/03_simulation_study.ipynb)  <p></p>  Runtime scaling for the unified weak-IV workflow. [PDF](assets/figures/runtime_scaling.pdf) Source: [08_runtime_scaling.ipynb](https://github.com/gsaco/ivrobust/blob/main/notebooks/08_runtime_scaling.ipynb)  <p>All figures are reproducible via <code>python scripts/build_figures.py</code>.</p>"},{"location":"how-to-cite/","title":"How to cite","text":"<p>ivrobust includes a <code>CITATION.cff</code> file in the repository root. Most reference managers and GitHub can read it directly.</p> <p>If you cite ivrobust in a paper, cite the package and the methodological references relevant to the estimators/tests you use (see References page).</p>"},{"location":"notebooks/","title":"Notebooks","text":"<p>The notebook suite lives in <code>notebooks/</code> (paired <code>.ipynb</code> and <code>.py</code> via Jupytext). Each notebook is reproducible, seeded, and produces multiple publication-quality figures.</p> <ul> <li> <p> 00 Quickstart</p> <p>Weak instruments in 10 minutes. Learn the unified API and confidence sets.</p> <p>Open notebook</p> </li> <li> <p> 01 Core API</p> <p>Data model, estimators, and the main entrypoints for inference.</p> <p>Open notebook</p> </li> <li> <p> 02 Diagnostics and inference</p> <p>Effective F, weak-ID diagnostics, and how they inform inference.</p> <p>Open notebook</p> </li> <li> <p> 03 Simulation study</p> <p>Monte Carlo checks for size and robustness under weak instruments.</p> <p>Open notebook</p> </li> <li> <p> 04 Real data example</p> <p>End-to-end workflow on a real dataset with reporting conventions.</p> <p>Open notebook</p> </li> <li> <p> 05 CLR in practice</p> <p>CLR confidence sets and diagnostics for applied settings.</p> <p>Open notebook</p> </li> <li> <p> 06 LM in practice</p> <p>LM/K confidence sets, p-value curves, and workflow patterns.</p> <p>Open notebook</p> </li> <li> <p> 07 Heteroskedasticity and clustering</p> <p>Compare covariance choices and clustering behavior.</p> <p>Open notebook</p> </li> <li> <p> 08 Runtime scaling</p> <p>Lightweight runtime scaling for weak-IV inference grids.</p> <p>Open notebook</p> </li> </ul> <p>Note</p> <p>Run notebooks with <code>pytest --nbmake</code> and launch locally with JupyterLab.</p>"},{"location":"parity/","title":"Parity and replication","text":"<p>ivrobust includes parity tests against reference implementations where available:</p> <ul> <li><code>tests/test_ar_vs_statsmodels.py</code> compares AR results to statsmodels.</li> <li><code>tests/test_lm_clr.py</code> compares LM/CLR to ivmodels when installed.</li> </ul> <p>Replication outputs are stored under <code>replication/outputs/</code> and validated by <code>tests/test_golden_replication.py</code>.</p>"},{"location":"quickstart/","title":"Quickstart","text":"<p>Get a weak-IV robust workflow in minutes.</p>"},{"location":"quickstart/#install","title":"Install","text":"<pre><code>python -m pip install \"ivrobust[plot]\"\n</code></pre>"},{"location":"quickstart/#run-weak-iv-robust-inference","title":"Run weak-IV robust inference","text":"Core workflowPlot p-value curvesConfidence sets <pre><code>import ivrobust as ivr\n\ndata, beta_true = ivr.weak_iv_dgp(n=300, k=5, strength=0.4, beta=1.0, seed=0)\n\nres = ivr.weakiv_inference(\n    data,\n    beta0=beta_true,\n    alpha=0.05,\n    methods=(\"AR\", \"LM\", \"CLR\"),\n    cov_type=\"HC1\",\n)\n\nprint(res.tests[\"AR\"].summary())\nprint(res.confidence_sets[\"CLR\"].intervals)\n</code></pre> <pre><code>res = ivr.weakiv_inference(\n    data,\n    beta0=beta_true,\n    alpha=0.05,\n    methods=(\"AR\", \"LM\", \"CLR\"),\n    cov_type=\"HC1\",\n    grid=(beta_true - 2.0, beta_true + 2.0, 301),\n    return_grid=True,\n)\n\nfig, ax = res.plot()\nivr.savefig(fig, \"artifacts/quickstart/pvalue_curve\", dpi=500)\n</code></pre> <pre><code>cs = ivr.ar_confidence_set(data, alpha=0.05, cov_type=\"HC1\")\nfig, ax = ivr.plot_ar_confidence_set(cs)\nivr.savefig(fig, \"artifacts/quickstart/ar_confidence_set\", dpi=500)\n</code></pre> <p>Tip</p> <p>For more detail, see the User guide and the curated Notebooks.</p>"},{"location":"references/","title":"References","text":"<p>The following references are foundational for weak-instrument robust inference and the methods implemented (or planned) in ivrobust.</p> <ul> <li>T. W. Anderson and Herman Rubin. Estimation of the parameters of a single equation in a complete system of stochastic equations. The Annals of Mathematical Statistics, 20(1):46\u201363, 1949. doi:10.1214/aoms/1177730090.</li> <li>Marcelo J. Moreira. A conditional likelihood ratio test for structural models. Econometrica, 71(4):1027\u20131048, 2003. doi:10.1111/1468-0262.00438.</li> <li>Anna Mikusheva. Robust confidence sets in the presence of weak instruments. Journal of Econometrics, 157(2):236\u2013247, 2010. doi:10.1016/j.jeconom.2009.12.003.</li> <li>Isaiah Andrews, James H. Stock, and Liyang Sun. Weak instruments in instrumental variables regression: theory and practice. Annual Review of Economics, 2019. doi:10.1146/annurev-economics-080218-025643.</li> <li>Jose Luis Montiel Olea and Carolin E. Pflueger. A robust test for weak instruments. Journal of Business &amp; Economic Statistics, 31(3):358\u2013369, 2013. doi:10.1080/00401706.2013.806694.</li> <li>Keith Finlay and Leandro M. Magnusson. Implementing weak-instrument robust tests for a general class of instrumental-variables models. The Stata Journal, 9(3):398\u2013421, 2009. doi:10.1177/1536867X0900900304.</li> <li>Frank Kleibergen. Pivotal statistics for testing structural parameters in instrumental variables regression. Econometrica, 70(5):1781\u20131803, 2002. doi:10.1111/1468-0262.00353.</li> </ul>"},{"location":"replication/","title":"Replication","text":"<p>This repository includes a lightweight replication harness under <code>replication/</code>.</p> <p>Contents</p> <ul> <li><code>replication/data/weak_iv_fixture.csv</code>: deterministic fixture used by golden tests.</li> <li><code>replication/outputs/golden.json</code>: committed reference outputs produced by ivrobust.</li> <li><code>replication/stata/ivreg2.do</code>: placeholder Stata script (ivreg2).</li> <li><code>replication/r/ivreg.R</code>: placeholder R script (AER::ivreg).</li> </ul> <p>Workflow</p> <ol> <li>Regenerate the golden outputs (Python):</li> </ol> <pre><code>python replication/generate_golden.py\n</code></pre> <ol> <li>Run Stata/R scripts to compare outputs against external packages.</li> <li>Replace <code>replication/outputs/golden.json</code> with verified results and re-run tests.</li> </ol> <p>Notes</p> <ul> <li>CI never runs Stata or R. The scripts are provided for reproducibility.</li> <li>The committed <code>golden.json</code> currently reflects ivrobust outputs on the fixture.</li> </ul>"},{"location":"reproducibility/","title":"Reproducibility","text":"<p>ivrobust is designed for reproducible, researcher-grade workflows. This page summarizes how the figures and notebooks in the documentation are generated.</p>"},{"location":"reproducibility/#seeds-and-determinism","title":"Seeds and determinism","text":"<ul> <li>Synthetic data in the docs use <code>weak_iv_dgp</code> with fixed random seeds.</li> <li>Figure generation scripts save both plots and cached data summaries.</li> <li>CI uses a fixed <code>PYTHONHASHSEED</code> to reduce non-determinism.</li> </ul>"},{"location":"reproducibility/#rebuild-figures","title":"Rebuild figures","text":"<pre><code>python scripts/build_figures.py\n</code></pre> <p>Figures are saved to <code>docs-src/assets/figures/</code> and cached data are stored in <code>docs-src/assets/data/</code> as <code>.npz</code> files.</p> <p>Using the Makefile shortcut:</p> <pre><code>make figures\n</code></pre>"},{"location":"reproducibility/#execute-notebooks","title":"Execute notebooks","text":"<pre><code>pytest --nbmake notebooks/*.ipynb\n</code></pre> <p>Notebooks are intentionally lightweight and use small sample sizes by default. Set environment variables or edit the notebook parameters if you need larger simulation sizes.</p>"},{"location":"reproducibility/#build-documentation","title":"Build documentation","text":"<pre><code>mkdocs build --strict\n</code></pre> <p>The MkDocs source lives in <code>docs-src/</code> and the built site is committed to <code>docs/</code> for GitHub Pages branch-based deployment.</p> <p>Makefile shortcut:</p> <pre><code>make docs\n</code></pre>"},{"location":"reproducibility/#link-checking","title":"Link checking","text":"<pre><code>python scripts/check_links.py --site-dir docs\nmake links\n</code></pre>"},{"location":"roadmap/","title":"Roadmap","text":"<p>This roadmap distinguishes between:</p> <ul> <li>P0: required for a stable release (current scope)</li> <li>P1: next methods and diagnostics</li> <li>P2: extended method coverage and performance work</li> </ul>"},{"location":"roadmap/#p0-current","title":"P0 (current)","text":"<ul> <li>AR/LM/CLR tests and confidence sets for a scalar structural parameter.</li> <li>HC0/HC1/HC2/HC3 and one-way cluster-robust covariance options.</li> <li>Effective F diagnostics for weak instruments.</li> <li>Verified implementation against a reference regression engine.</li> </ul>"},{"location":"roadmap/#p1-next","title":"P1 (next)","text":"<ul> <li>Multi-endogenous support with scalar-target inference.</li> <li>Many-instrument diagnostics and optional many-IV adjustments.</li> <li>HAC/serial correlation covariance extensions.</li> </ul>"},{"location":"roadmap/#p2-extended","title":"P2 (extended)","text":"<ul> <li>Formula interface (optional dependency) for applied workflows.</li> <li>Performance improvements (QR-based projections, caching repeated   cross-products).</li> </ul>"},{"location":"methods/","title":"Methods at a glance","text":"<p>ivrobust focuses on weak-IV robust inference for a single endogenous regressor. Use the unified workflow when you want consistent defaults and comparable output across AR, LM/K, and CLR procedures.</p> <pre><code>import ivrobust as ivr\n\nres = ivr.weakiv_inference(data, beta0=1.0, methods=(\"AR\", \"LM\", \"CLR\"))\nres.tests.keys(), res.confidence_sets.keys()\n</code></pre>"},{"location":"methods/#core-tests-and-confidence-sets","title":"Core tests and confidence sets","text":"<ul> <li> <p>Anderson-Rubin (AR)</p> <p>Joint test on instruments under the null with weak-ID robustness. Invert the AR test for set-valued confidence intervals. <sup>1</sup><sup>2</sup></p> </li> <li> <p>LM/K test</p> <p>Kleibergen-Paap LM statistic with covariance choices matched to your application. <sup>3</sup></p> </li> <li> <p>CLR / CQLR</p> <p>Conditional likelihood ratio inference with grid inversion for confidence sets. <sup>4</sup></p> </li> </ul>"},{"location":"methods/#scope-and-assumptions","title":"Scope and assumptions","text":"<ul> <li>The weak-IV robust tests in ivrobust target one endogenous regressor   (<code>p_endog=1</code>).</li> <li>Confidence sets are produced by test inversion and can be disjoint or   unbounded; report the full union of intervals.</li> <li>Robust covariance options (HC0-HC3 and clustering) apply across tests and   diagnostics.</li> </ul>"},{"location":"methods/#robust-covariance-and-diagnostics","title":"Robust covariance and diagnostics","text":"<ul> <li> <p>Robust covariance</p> <p>HC0-HC3 and one-way cluster robust options across tests and diagnostics. <sup>5</sup></p> </li> <li> <p>Set-valued confidence sets</p> <p>Disjoint, unbounded intervals are reported directly rather than trimmed. <sup>6</sup></p> </li> <li> <p>Diagnostics</p> <p>Effective F, KP-rk, and weak-ID diagnostics for instrument strength. <sup>7</sup></p> </li> </ul>"},{"location":"methods/#related-api-entrypoints","title":"Related API entrypoints","text":"<pre><code>ivr.ar_test(data, beta0=1.0)\nivr.lm_test(data, beta0=1.0)\nivr.clr_test(data, beta0=1.0)\n\nivr.ar_confidence_set(data, alpha=0.05)\nivr.lm_confidence_set(data, alpha=0.05)\nivr.clr_confidence_set(data, alpha=0.05)\n</code></pre> <p>See the User guide for method-specific details.</p> <ol> <li> <p>T. W. Anderson and Herman Rubin. Estimation of the parameters of a single equation in a complete system of stochastic equations. The Annals of Mathematical Statistics, 20(1):46\u201363, 1949. doi:10.1214/aoms/1177730090.\u00a0\u21a9</p> </li> <li> <p>Isaiah Andrews, James H. Stock, and Liyang Sun. Weak instruments in instrumental variables regression: theory and practice. Annual Review of Economics, 2019. doi:10.1146/annurev-economics-080218-025643.\u00a0\u21a9</p> </li> <li> <p>Frank Kleibergen. Pivotal statistics for testing structural parameters in instrumental variables regression. Econometrica, 70(5):1781\u20131803, 2002. doi:10.1111/1468-0262.00353.\u00a0\u21a9</p> </li> <li> <p>Marcelo J. Moreira. A conditional likelihood ratio test for structural models. Econometrica, 71(4):1027\u20131048, 2003. doi:10.1111/1468-0262.00438.\u00a0\u21a9</p> </li> <li> <p>Keith Finlay and Leandro M. Magnusson. Implementing weak-instrument robust tests for a general class of instrumental-variables models. The Stata Journal, 9(3):398\u2013421, 2009. doi:10.1177/1536867X0900900304.\u00a0\u21a9</p> </li> <li> <p>Anna Mikusheva. Robust confidence sets in the presence of weak instruments. Journal of Econometrics, 157(2):236\u2013247, 2010. doi:10.1016/j.jeconom.2009.12.003.\u00a0\u21a9</p> </li> <li> <p>Jose Luis Montiel Olea and Carolin E. Pflueger. A robust test for weak instruments. Journal of Business &amp; Economic Statistics, 31(3):358\u2013369, 2013. doi:10.1080/00401706.2013.806694.\u00a0\u21a9</p> </li> </ol>"},{"location":"reference/api/","title":"API reference","text":"<p>The API is organized around a unified weak-IV workflow, then the individual methods, diagnostics, and data structures that support it.</p>"},{"location":"reference/api/#unified-workflow","title":"Unified workflow","text":""},{"location":"reference/api/#ivrobust.weakiv.ar_confidence_set","title":"<code>ar_confidence_set(data: IVData, *, alpha: float = 0.05, cov: CovSpec | str | None = None, cov_type: CovType = 'HC1', clusters: np.ndarray | None = None, grid: FloatArray | None = None, beta_bounds: tuple[float, float] | None = None, n_grid: int = 2001, refine: bool = True, refine_tol: float = 1e-06, max_refine_iter: int = 80) -&gt; ConfidenceSetResult</code>","text":"<p>Invert the AR test to obtain a (possibly disjoint) confidence set for beta.</p>"},{"location":"reference/api/#ivrobust.weakiv.ar_test","title":"<code>ar_test(data: IVData, beta0: float | Sequence[float], *, cov: CovSpec | str | None = None, cov_type: CovType = 'HC1', clusters: np.ndarray | None = None, alpha: float | None = None) -&gt; ARTestResult</code>","text":"<p>Anderson-Rubin test of H0: beta = beta0 (single endogenous regressor).</p>"},{"location":"reference/api/#ivrobust.weakiv.clr_confidence_set","title":"<code>clr_confidence_set(data: IVData, *, alpha: float = 0.05, cov: CovSpec | str | None = None, cov_type: CovType = 'HC1', clusters: np.ndarray | None = None, method: Literal['CLR', 'CQLR'] = 'CQLR', grid: np.ndarray | None = None, beta_bounds: tuple[float, float] | None = None, n_grid: int = 2001, refine: bool = True, refine_tol: float = 1e-06, max_refine_iter: int = 80, tol: float = 1e-06) -&gt; ConfidenceSetResult</code>","text":"<p>Invert the CLR test to obtain a (possibly disjoint) confidence set for beta.</p>"},{"location":"reference/api/#ivrobust.weakiv.clr_test","title":"<code>clr_test(data: IVData, beta0: float | Sequence[float], *, cov: CovSpec | str | None = None, cov_type: CovType = 'HC1', clusters: np.ndarray | None = None, method: Literal['CLR', 'CQLR'] = 'CQLR', tol: float = 1e-06) -&gt; CLRTestResult</code>","text":"<p>Conditional likelihood ratio (CLR/CQLR) test for H0: beta = beta0 (scalar).</p>"},{"location":"reference/api/#ivrobust.weakiv.kp_rank_test","title":"<code>kp_rank_test(data: IVData, *, cov: CovSpec | str | None = None, cov_type: CovType = 'HC1', clusters: np.ndarray | None = None) -&gt; LMTestResult</code>","text":"<p>Kleibergen-Paap rk underidentification test (scalar endogenous regressor).</p>"},{"location":"reference/api/#ivrobust.weakiv.weakiv_inference","title":"<code>weakiv_inference(data: IVData, *, beta0: float | Sequence[float] | None = None, alpha: float = 0.05, methods: Iterable[str] = ('AR', 'LM', 'CLR'), cov: CovSpec | str | None = None, cov_type: CovType = 'HC1', clusters: np.ndarray | None = None, grid: np.ndarray | tuple[float, float, int] | None = None, return_grid: bool = False, recommended: str = 'CLR') -&gt; WeakIVInferenceResult</code>","text":"<p>Unified weak-IV robust inference workflow for AR/LM/CLR.</p>"},{"location":"reference/api/#core-tests-and-confidence-sets","title":"Core tests and confidence sets","text":""},{"location":"reference/api/#ivrobust.ar.ar_confidence_set","title":"<code>ar_confidence_set(data: IVData, *, alpha: float = 0.05, cov: CovSpec | str | None = None, cov_type: CovType = 'HC1', clusters: np.ndarray | None = None, grid: FloatArray | None = None, beta_bounds: tuple[float, float] | None = None, n_grid: int = 2001, refine: bool = True, refine_tol: float = 1e-06, max_refine_iter: int = 80) -&gt; ConfidenceSetResult</code>","text":"<p>Invert the AR test to obtain a (possibly disjoint) confidence set for beta.</p>"},{"location":"reference/api/#ivrobust.ar.ar_test","title":"<code>ar_test(data: IVData, beta0: float | Sequence[float], *, cov: CovSpec | str | None = None, cov_type: CovType = 'HC1', clusters: np.ndarray | None = None, alpha: float | None = None) -&gt; ARTestResult</code>","text":"<p>Anderson-Rubin test of H0: beta = beta0 (single endogenous regressor).</p>"},{"location":"reference/api/#ivrobust.lm.kp_lm_test","title":"<code>kp_lm_test(data: IVData, beta0: float | Sequence[float], *, cov: CovSpec | str | None = None, cov_type: CovType = 'HC1', clusters: np.ndarray | None = None, alpha: float | None = None) -&gt; LMTestResult</code>","text":"<p>Kleibergen-Paap LM test for H0: beta = beta0 (scalar).</p>"},{"location":"reference/api/#ivrobust.lm.kp_rank_test","title":"<code>kp_rank_test(data: IVData, *, cov: CovSpec | str | None = None, cov_type: CovType = 'HC1', clusters: np.ndarray | None = None) -&gt; LMTestResult</code>","text":"<p>Kleibergen-Paap rk underidentification test (scalar endogenous regressor).</p>"},{"location":"reference/api/#ivrobust.clr.clr_confidence_set","title":"<code>clr_confidence_set(data: IVData, *, alpha: float = 0.05, cov: CovSpec | str | None = None, cov_type: CovType = 'HC1', clusters: np.ndarray | None = None, method: Literal['CLR', 'CQLR'] = 'CQLR', grid: np.ndarray | None = None, beta_bounds: tuple[float, float] | None = None, n_grid: int = 2001, refine: bool = True, refine_tol: float = 1e-06, max_refine_iter: int = 80, tol: float = 1e-06) -&gt; ConfidenceSetResult</code>","text":"<p>Invert the CLR test to obtain a (possibly disjoint) confidence set for beta.</p>"},{"location":"reference/api/#ivrobust.clr.clr_test","title":"<code>clr_test(data: IVData, beta0: float | Sequence[float], *, cov: CovSpec | str | None = None, cov_type: CovType = 'HC1', clusters: np.ndarray | None = None, method: Literal['CLR', 'CQLR'] = 'CQLR', tol: float = 1e-06) -&gt; CLRTestResult</code>","text":"<p>Conditional likelihood ratio (CLR/CQLR) test for H0: beta = beta0 (scalar).</p>"},{"location":"reference/api/#diagnostics","title":"Diagnostics","text":""},{"location":"reference/api/#ivrobust.diagnostics.EffectiveFResult","title":"<code>EffectiveFResult</code>  <code>dataclass</code>","text":"<p>Effective F statistic for weak-instrument diagnostics (single endogenous regressor).</p>"},{"location":"reference/api/#ivrobust.diagnostics.FirstStageDiagnostics","title":"<code>FirstStageDiagnostics</code>  <code>dataclass</code>","text":"<p>First-stage diagnostics for a single endogenous regressor.</p>"},{"location":"reference/api/#ivrobust.diagnostics.cragg_donald_f","title":"<code>cragg_donald_f(data: IVData) -&gt; float</code>","text":"<p>Cragg-Donald F statistic (scalar endogenous regressor fallback).</p>"},{"location":"reference/api/#ivrobust.diagnostics.effective_f","title":"<code>effective_f(data: IVData, *, cov: CovSpec | str | None = None, cov_type: CovType = 'HC1', clusters: np.ndarray | None = None) -&gt; EffectiveFResult</code>","text":"<p>Compute the effective F statistic (Montiel Olea &amp; Pflueger) for p_endog=1.</p>"},{"location":"reference/api/#ivrobust.diagnostics.first_stage_diagnostics","title":"<code>first_stage_diagnostics(data: IVData) -&gt; FirstStageDiagnostics</code>","text":"<p>Compute classical first-stage F-statistic and partial R^2.</p>"},{"location":"reference/api/#ivrobust.diagnostics.stock_yogo_critical_values","title":"<code>stock_yogo_critical_values(k_endog: int, k_instr: int, *, size_distortion: float = 0.1) -&gt; float</code>","text":"<p>Stock-Yogo critical values for maximal size distortion (partial table).</p>"},{"location":"reference/api/#estimators-and-model","title":"Estimators and model","text":""},{"location":"reference/api/#data-containers-and-utilities","title":"Data containers and utilities","text":""},{"location":"reference/api/#ivrobust.data.ClusterSpec","title":"<code>ClusterSpec</code>  <code>dataclass</code>","text":"<p>Normalized cluster labels.</p> <p>codes are integer arrays with contiguous labels starting at 0.</p>"},{"location":"reference/api/#ivrobust.data.IVData","title":"<code>IVData</code>  <code>dataclass</code>","text":"<p>Canonical container for linear IV data with a fixed matrix layout.</p> Array shapes <p>y : (n, 1)     Outcome vector (single column). d : (n, p_endog)     Endogenous regressors. Weak-IV robust tests target p_endog=1. x : (n, p_exog)     Exogenous regressors. Include an intercept column if desired. z : (n, k_instr)     Excluded instruments. clusters : (n,)     Optional cluster labels for cluster-robust covariance.</p> Validation <ul> <li>Arrays are coerced to float64 (or int64 for clusters).</li> <li>NaN/inf values are rejected.</li> <li>All inputs must have the same number of rows.</li> </ul>"},{"location":"reference/api/#ivrobust.data.IVData.from_arrays","title":"<code>from_arrays(*, y: FloatArray, d: FloatArray, z: FloatArray, x: FloatArray | None = None, add_const: bool = True, clusters: IntArray | None = None) -&gt; IVData</code>  <code>classmethod</code>","text":"<p>Construct IVData from raw arrays with explicit keyword-only inputs.</p>"},{"location":"reference/api/#ivrobust.data.normalize_clusters","title":"<code>normalize_clusters(clusters: Sequence[np.ndarray] | np.ndarray, *, nobs: int) -&gt; ClusterSpec</code>","text":"<p>Normalize cluster labels to contiguous integer codes.</p> <p>Accepts a 1D array (one-way clustering) or a sequence of 1D arrays.</p>"},{"location":"reference/api/#ivrobust.data.partial_out","title":"<code>partial_out(x: FloatArray, *args: FloatArray) -&gt; tuple[FloatArray, ...]</code>","text":"<p>Residualize each array in args on x using QR-based projections.</p>"},{"location":"reference/api/#ivrobust.data.weak_iv_dgp","title":"<code>weak_iv_dgp(*, n: int, k: int, strength: float, beta: float, seed: int | None = None, rho: float = 0.5) -&gt; tuple[IVData, float]</code>","text":"<p>Generate a synthetic linear IV dataset with one endogenous regressor.</p>"},{"location":"reference/api/#ivrobust.covariance.compute_moment_cov","title":"<code>compute_moment_cov(*, X: FloatArray, resid: FloatArray, cov_type: CovType | None = 'HC1', clusters: IntArray | ClusterSpec | None = None, cov: CovSpec | str | Mapping[str, object] | None = None, hac_lags: int | None = None, kernel: str = 'bartlett', small_sample_adj: bool = True) -&gt; MomentCovarianceResult</code>","text":"<p>Compute sandwich covariance for moments based on regressors X and residuals.</p>"},{"location":"reference/api/#ivrobust.covariance.cov_ols","title":"<code>cov_ols(*, X: FloatArray, resid: FloatArray, cov_type: CovType | None = 'HC1', clusters: IntArray | ClusterSpec | None = None, cov: CovSpec | str | Mapping[str, object] | None = None, hac_lags: int | None = None, kernel: str = 'bartlett') -&gt; CovarianceResult</code>","text":"<p>Sandwich covariance for OLS coefficients.</p>"},{"location":"reference/api/#ivrobust.covariance.cov_reduced_form","title":"<code>cov_reduced_form(*, X: FloatArray, resid_y: FloatArray, resid_d: FloatArray, cov_type: CovType | None = 'HC1', clusters: IntArray | ClusterSpec | None = None, cov: CovSpec | str | Mapping[str, object] | None = None, small_sample_adj: bool = True, df_resid_adj: int | None = None, hac_lags: int | None = None, kernel: str = 'bartlett') -&gt; ReducedFormCovarianceResult</code>","text":"<p>Sandwich covariance for reduced-form coefficients of (y, d) on X.</p>"},{"location":"reference/api/#ivrobust.intervals.IntervalSet","title":"<code>IntervalSet</code>  <code>dataclass</code>","text":"<p>A (possibly disjoint) set of intervals on the real line.</p> <p>Intervals are represented as (lower, upper), where bounds may be -inf/inf.</p>"},{"location":"reference/api/#ivrobust.intervals.invert_pvalue_grid","title":"<code>invert_pvalue_grid(*, grid: FloatArray, pvalues: FloatArray, alpha: float, refine: bool, refine_tol: float, max_refine_iter: int, pvalue_func: Callable[[float], float] | None) -&gt; IntervalSet</code>","text":"<p>Invert a p-value curve on a grid into a union of intervals.</p>"},{"location":"reference/api/#plotting","title":"Plotting","text":""},{"location":"reference/api/#ivrobust.plots.plot_ar_confidence_set","title":"<code>plot_ar_confidence_set(cs: ConfidenceSetResult, *, ax: Any | None = None) -&gt; tuple[Any, Any]</code>","text":"<p>Plot an AR confidence set as horizontal intervals.</p> <p>Parameters:</p> Name Type Description Default <code>cs</code> <code>ConfidenceSetResult</code> <p>Output from <code>ar_confidence_set</code>.</p> required <code>ax</code> <code>Any | None</code> <p>Optional matplotlib Axes.</p> <code>None</code> <p>Returns:</p> Type Description <code>(fig, ax)</code>"},{"location":"reference/api/#ivrobust.plot_style.savefig","title":"<code>savefig(fig: Any, path: str | Path, *, formats: Iterable[str] = ('png', 'pdf'), dpi: int | None = None) -&gt; list[Path]</code>","text":"<p>Save a figure with ivrobust conventions.</p> <p>Parameters:</p> Name Type Description Default <code>fig</code> <code>Any</code> <p>Matplotlib Figure.</p> required <code>path</code> <code>str | Path</code> <p>Output path without suffix (recommended) or with suffix.</p> required <code>formats</code> <code>Iterable[str]</code> <p>Iterable of formats, e.g. (\"png\", \"pdf\").</p> <code>('png', 'pdf')</code> <code>dpi</code> <code>int | None</code> <p>Override DPI for raster formats. Default uses rcParams (300).</p> <code>None</code> <p>Returns:</p> Type Description <code>list[Path]</code> <p>Paths written.</p>"},{"location":"reference/api/#ivrobust.plot_style.set_style","title":"<code>set_style() -&gt; None</code>","text":"<p>Apply the ivrobust plotting style globally (matplotlib rcParams).</p> <p>This is the single style entrypoint. All plotting functions in ivrobust call <code>set_style()</code> internally to prevent drift across the package.</p>"},{"location":"reference/api/#ivrobust.plot_style.style_context","title":"<code>style_context() -&gt; Iterator[None]</code>","text":"<p>Context manager that applies ivrobust style and restores previous rcParams.</p>"},{"location":"user-guide/","title":"User guide","text":"<p>The user guide focuses on weak-IV robust inference workflows, from data setup to publication-ready plots.</p>"},{"location":"user-guide/#what-you-will-learn","title":"What you will learn","text":"<ul> <li>How <code>IVData</code> structures the model and assumptions.</li> <li>When to prefer AR, LM/K, or CLR inference.</li> <li>How to interpret diagnostics and effective F statistics.</li> <li>How to interpret diagnostics and safe defaults for reporting.</li> <li>How to report set-valued confidence sets and p-value curves.</li> </ul>"},{"location":"user-guide/#guide-map","title":"Guide map","text":"<ul> <li> <p> Anderson-Rubin inference</p> <p>Robust inference under weak identification.</p> <p>Read more</p> </li> <li> <p> LM/K test</p> <p>Kleibergen-Paap LM statistics and confidence sets.</p> <p>Read more</p> </li> <li> <p> CLR test</p> <p>Conditional likelihood ratio inference and grids.</p> <p>Read more</p> </li> <li> <p> Estimators</p> <p>2SLS, LIML, Fuller, and k-class estimators.</p> <p>Read more</p> </li> <li> <p> Diagnostics</p> <p>Effective F, weak-ID diagnostics, and rank tests.</p> <p>Read more</p> </li> <li> <p> Diagnostics &amp; interpretation</p> <p>Practical guidance on reading outputs and avoiding pitfalls.</p> <p>Read more</p> </li> <li> <p> Many instruments</p> <p>Guidance when k is large relative to n.</p> <p>Read more</p> </li> <li> <p> Plotting</p> <p>Style conventions and figure output for papers.</p> <p>Read more</p> </li> </ul>"},{"location":"user-guide/ar/","title":"Anderson-Rubin inference","text":"<p>The Anderson-Rubin (AR) approach performs inference on a structural parameter by testing whether excluded instruments predict the null-implied residual. This yields tests that remain valid under weak instruments.</p>"},{"location":"user-guide/ar/#model-and-null","title":"Model and null","text":"<p>Consider a linear IV model with one endogenous regressor \\(d\\):</p> \\[ y = \\beta d + x'\\gamma + u \\] <p>Given a null \\(H_0: \\beta = \\beta_0\\), define the null-implied outcome:</p> \\[ \\tilde y(\\beta_0) = y - \\beta_0 d \\] <p>The AR regression is:</p> \\[ \\tilde y(\\beta_0) \\sim x + z \\] <p>and the AR test is a joint test that coefficients on \\(z\\) are zero.</p>"},{"location":"user-guide/ar/#in-ivrobust","title":"In ivrobust","text":"<pre><code>import ivrobust as ivr\ndata, beta_true = ivr.weak_iv_dgp(n=300, k=5, strength=0.4, beta=1.0, seed=0)\n\nres = ivr.ar_test(data, beta0=beta_true, cov_type=\"HC1\")\nres.statistic, res.pvalue\n</code></pre> <p>Covariance options: <code>\"unadjusted\"</code>, <code>\"HC0\"</code>, <code>\"HC1\"</code>, <code>\"HC2\"</code>, <code>\"HC3\"</code>, and <code>\"cluster\"</code> (one-way clustering with <code>data.clusters</code>).</p> <p>Confidence sets return a <code>ConfidenceSetResult</code> with a union-of-intervals object:</p> <p>The AR confidence set is obtained by inverting the AR test across values of \\(\\beta\\).</p> <pre><code>cs = ivr.ar_confidence_set(data, alpha=0.05, cov_type=\"HC1\")\ncs.confidence_set.intervals\n</code></pre> <p>Intervals may be disjoint or unbounded; this is not a bug. It is a feature of weak-identification robust inference.</p> <p>References:</p> <ul> <li>Anderson, T. W., and Rubin, H. (1949). Estimation of the Parameters of a   Single Equation in a Complete System of Stochastic Equations. Annals of   Mathematical Statistics. DOI: 10.1214/aoms/1177730090.</li> <li>Andrews, I., Stock, J. H., and Sun, L. (2019). Weak Instruments in   Instrumental Variables Regression: Theory and Practice. Annual Review of   Economics. DOI: 10.1146/annurev-economics-080218-025643.</li> <li>Mikusheva, A. (2010). Robust confidence sets in the presence of weak   instruments. Journal of Econometrics. DOI: 10.1016/j.jeconom.2009.12.003.</li> </ul> <p>See the References page for formatted citations.</p>"},{"location":"user-guide/clr/","title":"CLR test","text":"<p>The Conditional Likelihood Ratio (CLR) test (Moreira, 2003) is a canonical weak-IV robust test with strong finite-sample properties. Its p-values are computed from a nonstandard distribution that depends on a concentration statistic.</p>"},{"location":"user-guide/clr/#in-ivrobust","title":"In ivrobust","text":"<pre><code>import ivrobust as ivr\ndata, beta_true = ivr.weak_iv_dgp(n=300, k=5, strength=0.4, beta=1.0, seed=0)\n\nres = ivr.clr_test(data, beta0=beta_true, cov_type=\"HC1\", method=\"CQLR\")\nres.statistic, res.pvalue\n\ncs = ivr.clr_confidence_set(data, alpha=0.05, cov_type=\"HC1\")\ncs.confidence_set.intervals\n</code></pre> <p>Notes:</p> <ul> <li>CLR confidence sets can be disjoint or unbounded under weak instruments.</li> <li>Set <code>method=\"CLR\"</code> for homoskedastic CLR; <code>method=\"CQLR\"</code> is the robust default.</li> <li>Use <code>weakiv_inference</code> to compute AR/LM/CLR tests and sets together.</li> <li>Available covariance types: <code>\"unadjusted\"</code>, <code>\"HC0\"</code>, <code>\"HC1\"</code>, <code>\"HC2\"</code>, <code>\"HC3\"</code>, <code>\"cluster\"</code>.</li> </ul> <p>References:</p> <ul> <li>Moreira, M. J. (2003). A Conditional Likelihood Ratio Test for Structural   Models. Econometrica.</li> <li>Mikusheva, A. (2010). Robust confidence sets in the presence of weak   instruments. Journal of Econometrics.</li> <li>Finlay, K., and Magnusson, L. M. (2009). Implementing weak-instrument robust   tests for a general class of instrumental-variables models. The Stata Journal.</li> </ul>"},{"location":"user-guide/diagnostics/","title":"Diagnostics","text":"<p>First-stage strength reporting is standard practice.</p> <p>ivrobust provides:</p> <ul> <li>Classical first-stage F-statistic</li> <li>Partial \\(R^2\\)</li> <li>Effective F (heteroskedasticity/cluster-robust)</li> <li>Kleibergen\u2013Paap rk statistic (underidentification)</li> <li>Cragg\u2013Donald F (scalar endogenous regressor)</li> <li>Stock\u2013Yogo critical values (partial table)</li> </ul> <pre><code>import ivrobust as ivr\ndata, _ = ivr.weak_iv_dgp(n=300, k=5, strength=0.4, beta=1.0, seed=0)\n\ndiag = ivr.first_stage_diagnostics(data)\ndiag.f_statistic, diag.partial_r2\n</code></pre>"},{"location":"user-guide/diagnostics/#effective-f-montiel-olea-pflueger","title":"Effective F (Montiel Olea-Pflueger)","text":"<p>The effective F statistic is designed to remain informative under heteroskedasticity or clustering. It is based on the robust covariance of the reduced-form coefficients in the first stage.</p> <pre><code>eff = ivr.effective_f(data, cov_type=\"HC1\")\neff.statistic\n</code></pre> <p>Reference: Montiel Olea and Pflueger (2013), DOI: 10.1080/00401706.2013.806694. See the References page for formatted citations.</p>"},{"location":"user-guide/diagnostics/#weak-id-summary","title":"Weak-ID summary","text":"<pre><code>diag = ivr.weak_id_diagnostics(data)\ndiag.kp_rk_stat, diag.kp_rk_pvalue\n</code></pre> <p>The <code>weak_id_diagnostics</code> helper bundles effective F, first-stage F, Kleibergen\u2013Paap rk, and Cragg\u2013Donald statistics for quick reporting.</p> <pre><code>ivr.stock_yogo_critical_values(k_endog=1, k_instr=3, size_distortion=0.10)\n</code></pre>"},{"location":"user-guide/diagnostics/#numerical-stability","title":"Numerical stability","text":"<p>ivrobust uses QR/SVD-based projections in its core linear algebra routines to avoid explicit matrix inversion. Rank-deficient designs trigger warnings and are handled with pseudo-inverse fallbacks where possible.</p>"},{"location":"user-guide/estimators/","title":"Estimators","text":"<p>ivrobust provides 2SLS/LIML/Fuller estimators primarily for workflow support (point estimates, conventional robust standard errors).</p> <p>Important: 2SLS standard errors are not weak-instrument robust. For weak-IV robust inference on the structural coefficient, use AR-based routines.</p> <pre><code>import ivrobust as ivr\ndata, _ = ivr.weak_iv_dgp(n=1000, k=3, strength=0.8, beta=2.0, seed=1)\n\nres = ivr.tsls(data, cov_type=\"HC1\")\nres.beta\n\nliml = ivr.liml(data, cov_type=\"HC1\")\nfuller = ivr.fuller(data, alpha=1.0, cov_type=\"HC1\")\n\nfit = ivr.fit(data, estimator=\"liml\", cov_type=\"HC1\")\nfit.params\n</code></pre> <p>Covariance options</p> <ul> <li><code>cov_type=\"HC0\"|\"HC1\"|\"HC2\"|\"HC3\"</code> for heteroskedasticity-robust SEs</li> <li><code>cov_type=\"cluster\"</code> for one-way cluster robust SEs</li> <li><code>cov_type=\"HAC\"</code> for Newey\u2013West-type SEs (Bartlett kernel, default lags)</li> </ul>"},{"location":"user-guide/estimators/#model-wrapper","title":"Model wrapper","text":"<p>If you prefer a model-style interface:</p> <pre><code>model = ivr.IVModel.from_arrays(\n    y=data.y,\n    x_endog=data.d,\n    z=data.z,\n    x_exog=None,\n    add_const=True,\n)\nresults = model.fit(estimator=\"liml\", cov_type=\"HC1\")\nresults.params\n</code></pre> <p>You can also call weak-IV robust inference from results:</p> <pre><code>weakiv = results.weakiv(methods=(\"AR\", \"LM\", \"CLR\"), alpha=0.05)\nweakiv.summary()\n</code></pre>"},{"location":"user-guide/lm/","title":"LM/K test","text":"<p>The Lagrange Multiplier (LM) or Kleibergen\u2013Paap K test is a weak-IV robust score test for a scalar structural parameter. It has a chi-square(1) asymptotic distribution under weak instruments.</p>"},{"location":"user-guide/lm/#in-ivrobust","title":"In ivrobust","text":"<pre><code>import ivrobust as ivr\ndata, beta_true = ivr.weak_iv_dgp(n=300, k=4, strength=0.5, beta=1.0, seed=0)\n\nres = ivr.lm_test(data, beta0=beta_true, cov_type=\"HC1\")\nres.statistic, res.pvalue\n\nrk = ivr.kp_rank_test(data, cov_type=\"HC1\")\nrk.statistic, rk.pvalue\n\ncs = ivr.lm_confidence_set(data, alpha=0.05, cov_type=\"HC1\")\ncs.confidence_set.intervals\n</code></pre> <p>Notes:</p> <ul> <li>LM confidence sets can be disjoint or unbounded under weak instruments.</li> <li>Use <code>cov_type=\"cluster\"</code> for one-way clustering (requires <code>data.clusters</code>).</li> <li>Available covariance types: <code>\"unadjusted\"</code>, <code>\"HC0\"</code>, <code>\"HC1\"</code>, <code>\"HC2\"</code>, <code>\"HC3\"</code>, <code>\"cluster\"</code>.</li> </ul> <p>References:</p> <ul> <li>Kleibergen, F. (2002). Pivotal statistics for testing structural parameters in   instrumental variables regression. Econometrica.</li> <li>Mikusheva, A. (2010). Robust confidence sets in the presence of weak   instruments. Journal of Econometrics.</li> <li>Finlay, K., and Magnusson, L. M. (2009). Implementing weak-instrument robust   tests for a general class of instrumental-variables models. The Stata Journal.</li> </ul>"},{"location":"user-guide/many_instruments/","title":"Many Instruments","text":"<p>When the number of instruments grows relative to sample size, conventional first-stage F statistics can overstate strength. ivrobust exposes diagnostics that remain meaningful under many-instrument asymptotics.</p> <p>Key diagnostics</p> <ul> <li>Effective F (Montiel Olea\u2013Pflueger): heteroskedastic/cluster-robust strength.</li> <li>Kleibergen\u2013Paap rk statistic: underidentification test.</li> <li>Cragg\u2013Donald F (scalar endog): classical counterpart for comparison.</li> <li>Stock\u2013Yogo critical values: rule-of-thumb thresholds (partial table).</li> </ul> <p>Example</p> <pre><code>import ivrobust as ivr\n\ndata, _ = ivr.weak_iv_dgp(n=300, k=10, strength=0.3, beta=1.0, seed=0)\n\ndiag = ivr.weak_id_diagnostics(data)\ndiag.effective_f, diag.kp_rk_stat\n</code></pre> <p>Interpretation</p> <ul> <li>Effective F below ~10 signals weak identification in many settings.</li> <li>The rk test p-value near 0 indicates underidentification.</li> <li>Stock\u2013Yogo critical values provide reference cutoffs for size distortions.</li> </ul>"},{"location":"user-guide/plotting/","title":"Plotting","text":"<p>ivrobust uses a single, package-wide plotting style. It is intentionally conservative:</p> <ul> <li>White background</li> <li>Grayscale defaults</li> <li>Black edges and spines</li> <li>No seaborn styling</li> <li>Vector-friendly saving (PDF) plus high-DPI PNG</li> </ul>"},{"location":"user-guide/plotting/#style-entrypoint","title":"Style entrypoint","text":"<pre><code>import ivrobust as ivr\nivr.set_style()\n</code></pre> <p>The same settings are also available as a Matplotlib style file:</p> <pre><code>import matplotlib.pyplot as plt\nplt.style.use(\"docs-src/assets/ivrobust.mplstyle\")\n</code></pre> <p>Saving figures:</p> <pre><code>paths = ivr.savefig(fig, \"artifacts/figures/example\", formats=(\"png\", \"pdf\"))\npaths\n</code></pre>"},{"location":"user-guide/plotting/#weak-iv-p-value-curves","title":"Weak-IV p-value curves","text":"<pre><code>res = ivr.weakiv_inference(\n    data,\n    beta0=beta_true,\n    alpha=0.05,\n    methods=(\"AR\", \"LM\", \"CLR\"),\n    cov_type=\"HC1\",\n    return_grid=True,\n)\nfig, ax = res.plot()\n</code></pre>"}]}